

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>propka.parameters &mdash; PROPKA 3 3.2.0 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> PROPKA 3
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">1. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart.html">2. Quickstart Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../command.html">3. <strong class="program">propka3</strong> command</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">4. API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../references.html">5. References</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">PROPKA 3</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>propka.parameters</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for propka.parameters</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Configuration file parameters</span>
<span class="sd">=============================</span>

<span class="sd">Holds parameters and settings that can be set in :file:`propka.cfg`. The file format consists of lines of  ``keyword value [value ...]``, blank lines, and comment lines (introduced with ``#``).</span>

<span class="sd">The module attributes below list the names and types of all key words</span>
<span class="sd">in configuration file.</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">propka.lib</span> <span class="kn">import</span> <span class="n">info</span><span class="p">,</span> <span class="n">warning</span>


<span class="c1">#: matrices</span>
<span class="n">MATRICES</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;interaction_matrix&#39;</span><span class="p">]</span>
<span class="c1">#: pari-wise matrices</span>
<span class="n">PAIR_WISE_MATRICES</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sidechain_cutoffs&#39;</span><span class="p">]</span>
<span class="c1">#: :class:`dict` containing numbers</span>
<span class="n">NUMBER_DICTIONARIES</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;VanDerWaalsVolume&#39;</span><span class="p">,</span> <span class="s1">&#39;charge&#39;</span><span class="p">,</span> <span class="s1">&#39;model_pkas&#39;</span><span class="p">,</span> <span class="s1">&#39;ions&#39;</span><span class="p">,</span> <span class="s1">&#39;valence_electrons&#39;</span><span class="p">,</span>
    <span class="s1">&#39;custom_model_pkas&#39;</span><span class="p">]</span>
<span class="c1">#: :class:`dict` containing lists</span>
<span class="n">LIST_DICTIONARIES</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;backbone_NH_hydrogen_bond&#39;</span><span class="p">,</span> <span class="s1">&#39;backbone_CO_hydrogen_bond&#39;</span><span class="p">]</span>
<span class="c1">#: :class:`dict` containing strings</span>
<span class="n">STRING_DICTIONARIES</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;protein_group_mapping&#39;</span><span class="p">]</span>
<span class="c1">#: :class:`list` containing strings</span>
<span class="n">STRING_LISTS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;ignore_residues&#39;</span><span class="p">,</span> <span class="s1">&#39;angular_dependent_sidechain_interactions&#39;</span><span class="p">,</span>
    <span class="s1">&#39;acid_list&#39;</span><span class="p">,</span> <span class="s1">&#39;base_list&#39;</span><span class="p">,</span> <span class="s1">&#39;exclude_sidechain_interactions&#39;</span><span class="p">,</span>
    <span class="s1">&#39;backbone_reorganisation_list&#39;</span><span class="p">,</span> <span class="s1">&#39;write_out_order&#39;</span><span class="p">]</span>
<span class="c1">#: distances (:class:`float`)</span>
<span class="n">DISTANCES</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;desolv_cutoff&#39;</span><span class="p">,</span> <span class="s1">&#39;buried_cutoff&#39;</span><span class="p">,</span> <span class="s1">&#39;coulomb_cutoff1&#39;</span><span class="p">,</span>
             <span class="s1">&#39;coulomb_cutoff2&#39;</span><span class="p">]</span>
<span class="c1">#: other parameters</span>
<span class="n">PARAMETERS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;Nmin&#39;</span><span class="p">,</span> <span class="s1">&#39;Nmax&#39;</span><span class="p">,</span> <span class="s1">&#39;desolvationSurfaceScalingFactor&#39;</span><span class="p">,</span> <span class="s1">&#39;desolvationPrefactor&#39;</span><span class="p">,</span>
    <span class="s1">&#39;desolvationAllowance&#39;</span><span class="p">,</span> <span class="s1">&#39;coulomb_diel&#39;</span><span class="p">,</span> <span class="s1">&#39;COO_HIS_exception&#39;</span><span class="p">,</span>
    <span class="s1">&#39;OCO_HIS_exception&#39;</span><span class="p">,</span> <span class="s1">&#39;CYS_HIS_exception&#39;</span><span class="p">,</span> <span class="s1">&#39;CYS_CYS_exception&#39;</span><span class="p">,</span>
    <span class="s1">&#39;min_ligand_model_pka&#39;</span><span class="p">,</span> <span class="s1">&#39;max_ligand_model_pka&#39;</span><span class="p">,</span>
    <span class="s1">&#39;include_H_in_interactions&#39;</span><span class="p">,</span> <span class="s1">&#39;coupling_max_number_of_bonds&#39;</span><span class="p">,</span>
    <span class="s1">&#39;min_bond_distance_for_hydrogen_bonds&#39;</span><span class="p">,</span> <span class="s1">&#39;coupling_penalty&#39;</span><span class="p">,</span>
    <span class="s1">&#39;shared_determinants&#39;</span><span class="p">,</span> <span class="s1">&#39;common_charge_centre&#39;</span><span class="p">,</span> <span class="s1">&#39;hide_penalised_group&#39;</span><span class="p">,</span>
    <span class="s1">&#39;remove_penalised_group&#39;</span><span class="p">,</span> <span class="s1">&#39;max_intrinsic_pka_diff&#39;</span><span class="p">,</span>
    <span class="s1">&#39;min_interaction_energy&#39;</span><span class="p">,</span> <span class="s1">&#39;max_free_energy_diff&#39;</span><span class="p">,</span> <span class="s1">&#39;min_swap_pka_shift&#39;</span><span class="p">,</span>
    <span class="s1">&#39;min_pka&#39;</span><span class="p">,</span> <span class="s1">&#39;max_pka&#39;</span><span class="p">,</span> <span class="s1">&#39;sidechain_interaction&#39;</span><span class="p">]</span>
<span class="c1"># :class:`str` parameters</span>
<span class="n">STRINGS</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;version&#39;</span><span class="p">,</span> <span class="s1">&#39;output_file_tag&#39;</span><span class="p">,</span> <span class="s1">&#39;ligand_typing&#39;</span><span class="p">,</span> <span class="s1">&#39;pH&#39;</span><span class="p">,</span> <span class="s1">&#39;reference&#39;</span><span class="p">]</span>


<div class="viewcode-block" id="Parameters"><a class="viewcode-back" href="../../api/propka.parameters.html#propka.parameters.Parameters">[docs]</a><span class="k">class</span> <span class="nc">Parameters</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;PROPKA parameter class.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize parameter class.</span>

<span class="sd">        Args:</span>
<span class="sd">            parameter_file:  file with parameters</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># TODO - need to define all members explicitly</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model_pkas</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">interaction_matrix</span> <span class="o">=</span> <span class="n">InteractionMatrix</span><span class="p">(</span><span class="s2">&quot;interaction_matrix&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sidechain_cutoffs</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># TODO - it would be nice to rename these; they&#39;re defined everywhere</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">COO_HIS_exception</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">OCO_HIS_exception</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CYS_HIS_exception</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CYS_CYS_exception</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># These functions set up remaining data structures implicitly</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_up_data_structures</span><span class="p">()</span>

<div class="viewcode-block" id="Parameters.parse_line"><a class="viewcode-back" href="../../api/propka.parameters.html#propka.parameters.Parameters.parse_line">[docs]</a>    <span class="k">def</span> <span class="nf">parse_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parse parameter file line.&quot;&quot;&quot;</span>
        <span class="c1"># first, remove comments</span>
        <span class="n">comment_pos</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">comment_pos</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="p">[:</span><span class="n">comment_pos</span><span class="p">]</span>
        <span class="c1"># split the line into words</span>
        <span class="n">words</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="c1"># parse the words</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">NUMBER_DICTIONARIES</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parse_to_number_dictionary</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">STRING_LISTS</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parse_to_string_list</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">DISTANCES</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parse_distance</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">PARAMETERS</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parse_parameter</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">STRINGS</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parse_string</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">LIST_DICTIONARIES</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parse_to_list_dictionary</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">MATRICES</span><span class="o">+</span><span class="n">PAIR_WISE_MATRICES</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parse_to_matrix</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">STRING_DICTIONARIES</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parse_to_string_dictionary</span><span class="p">(</span><span class="n">words</span><span class="p">)</span></div>

<div class="viewcode-block" id="Parameters.parse_to_number_dictionary"><a class="viewcode-back" href="../../api/propka.parameters.html#propka.parameters.Parameters.parse_to_number_dictionary">[docs]</a>    <span class="k">def</span> <span class="nf">parse_to_number_dictionary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">words</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parse field to number dictionary.</span>

<span class="sd">        Args:</span>
<span class="sd">            words:  strings to parse.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dict_</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">dict_</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="Parameters.parse_to_string_dictionary"><a class="viewcode-back" href="../../api/propka.parameters.html#propka.parameters.Parameters.parse_to_string_dictionary">[docs]</a>    <span class="k">def</span> <span class="nf">parse_to_string_dictionary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">words</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parse field to string dictionary.</span>

<span class="sd">        Args:</span>
<span class="sd">            words:  strings to parse</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dict_</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">dict_</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span></div>

<div class="viewcode-block" id="Parameters.parse_to_list_dictionary"><a class="viewcode-back" href="../../api/propka.parameters.html#propka.parameters.Parameters.parse_to_list_dictionary">[docs]</a>    <span class="k">def</span> <span class="nf">parse_to_list_dictionary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">words</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parse field to list dictionary.</span>

<span class="sd">        Args:</span>
<span class="sd">            words:  strings to parse.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dict_</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dict_</span><span class="p">:</span>
            <span class="n">dict_</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">words</span><span class="p">[</span><span class="mi">2</span><span class="p">:]:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">dict_</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">value</span><span class="p">])</span>
            <span class="n">dict_</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></div>

<div class="viewcode-block" id="Parameters.parse_to_string_list"><a class="viewcode-back" href="../../api/propka.parameters.html#propka.parameters.Parameters.parse_to_string_list">[docs]</a>    <span class="k">def</span> <span class="nf">parse_to_string_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">words</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parse field to string list.</span>

<span class="sd">        Args:</span>
<span class="sd">            words:  strings to parse</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">list_</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">list_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="Parameters.parse_to_matrix"><a class="viewcode-back" href="../../api/propka.parameters.html#propka.parameters.Parameters.parse_to_matrix">[docs]</a>    <span class="k">def</span> <span class="nf">parse_to_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">words</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parse field to matrix.</span>

<span class="sd">        Args:</span>
<span class="sd">            words:  strings to parse</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">matrix</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">value</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
        <span class="n">matrix</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="Parameters.parse_distance"><a class="viewcode-back" href="../../api/propka.parameters.html#propka.parameters.Parameters.parse_distance">[docs]</a>    <span class="k">def</span> <span class="nf">parse_distance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">words</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parse field to distance.</span>

<span class="sd">        Args:</span>
<span class="sd">            words:  strings to parse</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">value</span><span class="p">)</span>
        <span class="n">value_sq</span> <span class="o">=</span> <span class="n">value</span><span class="o">*</span><span class="n">value</span>
        <span class="n">attr</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{0:s}</span><span class="s2">_squared&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">value_sq</span><span class="p">)</span></div>

<div class="viewcode-block" id="Parameters.parse_parameter"><a class="viewcode-back" href="../../api/propka.parameters.html#propka.parameters.Parameters.parse_parameter">[docs]</a>    <span class="k">def</span> <span class="nf">parse_parameter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">words</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parse field to parameters.</span>

<span class="sd">        Args:</span>
<span class="sd">            words:  strings to parse</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="Parameters.parse_string"><a class="viewcode-back" href="../../api/propka.parameters.html#propka.parameters.Parameters.parse_string">[docs]</a>    <span class="k">def</span> <span class="nf">parse_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">words</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parse field to strings.</span>

<span class="sd">        Args:</span>
<span class="sd">            words:  strings to parse</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span></div>

<div class="viewcode-block" id="Parameters.set_up_data_structures"><a class="viewcode-back" href="../../api/propka.parameters.html#propka.parameters.Parameters.set_up_data_structures">[docs]</a>    <span class="k">def</span> <span class="nf">set_up_data_structures</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set up internal data structures.</span>

<span class="sd">        TODO - it would be better to make these assignments explicit in</span>
<span class="sd">        __init__.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">key_word</span> <span class="ow">in</span> <span class="p">(</span><span class="n">NUMBER_DICTIONARIES</span> <span class="o">+</span> <span class="n">LIST_DICTIONARIES</span>
                         <span class="o">+</span> <span class="n">STRING_DICTIONARIES</span><span class="p">):</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_word</span><span class="p">,</span> <span class="p">{})</span>
        <span class="k">for</span> <span class="n">key_word</span> <span class="ow">in</span> <span class="n">STRING_LISTS</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_word</span><span class="p">,</span> <span class="p">[])</span>
        <span class="k">for</span> <span class="n">key_word</span> <span class="ow">in</span> <span class="n">STRINGS</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_word</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key_word</span> <span class="ow">in</span> <span class="n">MATRICES</span><span class="p">:</span>
            <span class="n">matrix</span> <span class="o">=</span> <span class="n">InteractionMatrix</span><span class="p">(</span><span class="n">key_word</span><span class="p">)</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_word</span><span class="p">,</span> <span class="n">matrix</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key_word</span> <span class="ow">in</span> <span class="n">PAIR_WISE_MATRICES</span><span class="p">:</span>
            <span class="n">matrix</span> <span class="o">=</span> <span class="n">PairwiseMatrix</span><span class="p">(</span><span class="n">key_word</span><span class="p">)</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_word</span><span class="p">,</span> <span class="n">matrix</span><span class="p">)</span></div>

<div class="viewcode-block" id="Parameters.print_interaction_parameters"><a class="viewcode-back" href="../../api/propka.parameters.html#propka.parameters.Parameters.print_interaction_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">print_interaction_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Print interaction parameters.&quot;&quot;&quot;</span>
        <span class="n">info</span><span class="p">(</span><span class="s1">&#39;--------------- Model pKa values ----------------------&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_pkas</span><span class="p">:</span>
            <span class="n">info</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:&gt;3s}</span><span class="s1"> </span><span class="si">{1:8.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_pkas</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span>

        <span class="n">info</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">info</span><span class="p">(</span><span class="s1">&#39;--------------- Interactions --------------------------&#39;</span><span class="p">)</span>
        <span class="n">agroups</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;COO&#39;</span><span class="p">,</span> <span class="s1">&#39;HIS&#39;</span><span class="p">,</span> <span class="s1">&#39;CYS&#39;</span><span class="p">,</span> <span class="s1">&#39;TYR&#39;</span><span class="p">,</span> <span class="s1">&#39;SER&#39;</span><span class="p">,</span> <span class="s1">&#39;N+&#39;</span><span class="p">,</span> <span class="s1">&#39;LYS&#39;</span><span class="p">,</span> <span class="s1">&#39;AMD&#39;</span><span class="p">,</span> <span class="s1">&#39;ARG&#39;</span><span class="p">,</span>
            <span class="s1">&#39;TRP&#39;</span><span class="p">,</span> <span class="s1">&#39;ROH&#39;</span><span class="p">,</span> <span class="s1">&#39;CG&#39;</span><span class="p">,</span> <span class="s1">&#39;C2N&#39;</span><span class="p">,</span> <span class="s1">&#39;N30&#39;</span><span class="p">,</span> <span class="s1">&#39;N31&#39;</span><span class="p">,</span> <span class="s1">&#39;N32&#39;</span><span class="p">,</span> <span class="s1">&#39;N33&#39;</span><span class="p">,</span> <span class="s1">&#39;NAR&#39;</span><span class="p">,</span>
            <span class="s1">&#39;OCO&#39;</span><span class="p">,</span> <span class="s1">&#39;NP1&#39;</span><span class="p">,</span> <span class="s1">&#39;OH&#39;</span><span class="p">,</span> <span class="s1">&#39;O3&#39;</span><span class="p">,</span> <span class="s1">&#39;CL&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;NAM&#39;</span><span class="p">,</span> <span class="s1">&#39;N1&#39;</span><span class="p">,</span> <span class="s1">&#39;O2&#39;</span><span class="p">,</span> <span class="s1">&#39;OP&#39;</span><span class="p">,</span> <span class="s1">&#39;SH&#39;</span><span class="p">]</span>
        <span class="n">lgroups</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;CG&#39;</span><span class="p">,</span> <span class="s1">&#39;C2N&#39;</span><span class="p">,</span> <span class="s1">&#39;N30&#39;</span><span class="p">,</span> <span class="s1">&#39;N31&#39;</span><span class="p">,</span> <span class="s1">&#39;N32&#39;</span><span class="p">,</span> <span class="s1">&#39;N33&#39;</span><span class="p">,</span> <span class="s1">&#39;NAR&#39;</span><span class="p">,</span> <span class="s1">&#39;OCO&#39;</span><span class="p">,</span> <span class="s1">&#39;NP1&#39;</span><span class="p">,</span>
            <span class="s1">&#39;OH&#39;</span><span class="p">,</span> <span class="s1">&#39;O3&#39;</span><span class="p">,</span> <span class="s1">&#39;CL&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;NAM&#39;</span><span class="p">,</span> <span class="s1">&#39;N1&#39;</span><span class="p">,</span> <span class="s1">&#39;O2&#39;</span><span class="p">,</span> <span class="s1">&#39;OP&#39;</span><span class="p">,</span> <span class="s1">&#39;SH&#39;</span><span class="p">]</span>
        <span class="n">map_</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;CG&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;ARG&#39;</span><span class="p">],</span> <span class="s1">&#39;C2N&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;ARG&#39;</span><span class="p">],</span> <span class="s1">&#39;N30&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;N+&#39;</span><span class="p">,</span> <span class="s1">&#39;LYS&#39;</span><span class="p">],</span>
            <span class="s1">&#39;N31&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;N+&#39;</span><span class="p">,</span> <span class="s1">&#39;LYS&#39;</span><span class="p">],</span> <span class="s1">&#39;N32&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;N+&#39;</span><span class="p">,</span> <span class="s1">&#39;LYS&#39;</span><span class="p">],</span> <span class="s1">&#39;N33&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;N+&#39;</span><span class="p">,</span> <span class="s1">&#39;LYS&#39;</span><span class="p">],</span>
            <span class="s1">&#39;NAR&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;HIS&#39;</span><span class="p">],</span> <span class="s1">&#39;OCO&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;COO&#39;</span><span class="p">],</span> <span class="s1">&#39;OP&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;SH&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;CYS&#39;</span><span class="p">],</span>
            <span class="s1">&#39;NP1&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;OH&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;ROH&#39;</span><span class="p">],</span> <span class="s1">&#39;O3&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;CL&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s1">&#39;NAM&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;AMD&#39;</span><span class="p">],</span> <span class="s1">&#39;N1&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;O2&#39;</span><span class="p">:</span> <span class="p">[]}</span>
        <span class="k">for</span> <span class="n">group1</span> <span class="ow">in</span> <span class="n">agroups</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">group2</span> <span class="ow">in</span> <span class="n">lgroups</span><span class="p">:</span>
                <span class="n">fmt</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{grp1:&gt;3s}</span><span class="s2"> </span><span class="si">{grp2:&gt;3s}</span><span class="s2"> </span><span class="si">{mat:1s}</span><span class="s2"> </span><span class="si">{val1:4}</span><span class="s2"> </span><span class="si">{val2:4}</span><span class="s2">&quot;</span>
                <span class="n">interaction</span> <span class="o">=</span> <span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">grp1</span><span class="o">=</span><span class="n">group1</span><span class="p">,</span> <span class="n">grp2</span><span class="o">=</span><span class="n">group2</span><span class="p">,</span>
                    <span class="n">mat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">interaction_matrix</span><span class="p">[</span><span class="n">group1</span><span class="p">][</span><span class="n">group2</span><span class="p">],</span>
                    <span class="n">val1</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sidechain_cutoffs</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="n">group1</span><span class="p">,</span> <span class="n">group2</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="n">val2</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sidechain_cutoffs</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="n">group1</span><span class="p">,</span> <span class="n">group2</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">map_interaction</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                <span class="k">if</span> <span class="n">group2</span> <span class="ow">in</span> <span class="n">map_</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">map_</span><span class="p">[</span><span class="n">group2</span><span class="p">]:</span>
                        <span class="n">fmt</span> <span class="o">=</span> <span class="s2">&quot;|</span><span class="si">{grp1:&gt;3s}</span><span class="s2"> </span><span class="si">{grp2:&gt;3s}</span><span class="s2"> </span><span class="si">{mat:1s}</span><span class="s2"> </span><span class="si">{val1:4}</span><span class="s2"> </span><span class="si">{val2:4}</span><span class="s2">&quot;</span>
                        <span class="n">map_interaction</span> <span class="o">+=</span> <span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                            <span class="n">group1</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">interaction_matrix</span><span class="p">[</span><span class="n">group1</span><span class="p">][</span><span class="n">val</span><span class="p">],</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">sidechain_cutoffs</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="n">group1</span><span class="p">,</span> <span class="n">val</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">sidechain_cutoffs</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="n">group1</span><span class="p">,</span> <span class="n">val</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
                        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">interaction_matrix</span><span class="p">[</span><span class="n">group1</span><span class="p">][</span><span class="n">val</span><span class="p">]</span>
                                <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interaction_matrix</span><span class="p">[</span><span class="n">group1</span><span class="p">][</span><span class="n">group2</span><span class="p">]):</span>
                            <span class="n">map_interaction</span> <span class="o">+=</span> <span class="s1">&#39;* &#39;</span>
                        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sidechain_cutoffs</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="n">group1</span><span class="p">,</span> <span class="n">val</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                                <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sidechain_cutoffs</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span>
                                    <span class="n">group1</span><span class="p">,</span> <span class="n">group2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                                <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">sidechain_cutoffs</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span>
                                    <span class="n">group1</span><span class="p">,</span> <span class="n">val</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
                                <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sidechain_cutoffs</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span>
                                    <span class="n">group1</span><span class="p">,</span> <span class="n">group2</span><span class="p">)[</span><span class="mi">1</span><span class="p">]):</span>
                            <span class="n">map_interaction</span> <span class="o">+=</span> <span class="s1">&#39;! &#39;</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">map_interaction</span> <span class="o">+=</span> <span class="s1">&#39;  &#39;</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">map_</span><span class="p">[</span><span class="n">group2</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span>
                            <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sidechain_cutoffs</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span>
                                <span class="n">group1</span><span class="p">,</span> <span class="n">group2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                                 <span class="o">!=</span> <span class="mi">3</span>
                                 <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">sidechain_cutoffs</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span>
                                     <span class="n">group1</span><span class="p">,</span> <span class="n">group2</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
                                 <span class="o">!=</span> <span class="mi">4</span><span class="p">)):</span>
                        <span class="n">map_interaction</span> <span class="o">+=</span> <span class="s1">&#39;?  &#39;</span>
                <span class="n">info</span><span class="p">(</span><span class="n">interaction</span><span class="p">,</span> <span class="n">map_interaction</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">group1</span> <span class="o">==</span> <span class="n">group2</span><span class="p">:</span>
                    <span class="k">break</span>
            <span class="n">info</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
        <span class="n">info</span><span class="p">(</span><span class="s1">&#39;--------------- Exceptions ----------------------------&#39;</span><span class="p">)</span>
        <span class="n">info</span><span class="p">(</span><span class="s1">&#39;COO-HIS&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">COO_HIS_exception</span><span class="p">)</span>
        <span class="n">info</span><span class="p">(</span><span class="s1">&#39;OCO-HIS&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OCO_HIS_exception</span><span class="p">)</span>
        <span class="n">info</span><span class="p">(</span><span class="s1">&#39;CYS-HIS&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">CYS_HIS_exception</span><span class="p">)</span>
        <span class="n">info</span><span class="p">(</span><span class="s1">&#39;CYS-CYS&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">CYS_CYS_exception</span><span class="p">)</span>

        <span class="n">info</span><span class="p">(</span><span class="s1">&#39;--------------- Mapping -------------------------------&#39;</span><span class="p">)</span>
        <span class="n">info</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">Titratable:</span>
<span class="s2">CG  ARG</span>
<span class="s2">C2N ARG</span>
<span class="s2">N30 N+/LYS</span>
<span class="s2">N31 N+/LYS</span>
<span class="s2">N32 N+/LYS</span>
<span class="s2">N33 N+/LYS</span>
<span class="s2">NAR HIS</span>
<span class="s2">OCO COO</span>
<span class="s2">OP  TYR/SER?</span>
<span class="s2">SH  CYS</span>

<span class="s2">Non-titratable:</span>
<span class="s2">NP1 AMD?</span>
<span class="s2">OH  ROH</span>
<span class="s2">O3  ?</span>
<span class="s2">CL</span>
<span class="s2">F</span>
<span class="s2">NAM</span>
<span class="s2">N1</span>
<span class="s2">O2</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Parameters.print_interaction_parameters_latex"><a class="viewcode-back" href="../../api/propka.parameters.html#propka.parameters.Parameters.print_interaction_parameters_latex">[docs]</a>    <span class="k">def</span> <span class="nf">print_interaction_parameters_latex</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Print interaction parameters in LaTeX format.&quot;&quot;&quot;</span>
        <span class="c1"># TODO - if these lists and dictionaries are the same as above, then</span>
        <span class="c1"># should be constants at the level of the module</span>
        <span class="n">agroups</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;COO&#39;</span><span class="p">,</span> <span class="s1">&#39;HIS&#39;</span><span class="p">,</span> <span class="s1">&#39;CYS&#39;</span><span class="p">,</span> <span class="s1">&#39;TYR&#39;</span><span class="p">,</span> <span class="s1">&#39;SER&#39;</span><span class="p">,</span> <span class="s1">&#39;N+&#39;</span><span class="p">,</span> <span class="s1">&#39;LYS&#39;</span><span class="p">,</span> <span class="s1">&#39;AMD&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;ARG&#39;</span><span class="p">,</span> <span class="s1">&#39;TRP&#39;</span><span class="p">,</span> <span class="s1">&#39;ROH&#39;</span><span class="p">,</span> <span class="s1">&#39;CG&#39;</span><span class="p">,</span> <span class="s1">&#39;C2N&#39;</span><span class="p">,</span> <span class="s1">&#39;N30&#39;</span><span class="p">,</span> <span class="s1">&#39;N31&#39;</span><span class="p">,</span> <span class="s1">&#39;N32&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;N33&#39;</span><span class="p">,</span> <span class="s1">&#39;NAR&#39;</span><span class="p">,</span> <span class="s1">&#39;OCO&#39;</span><span class="p">,</span> <span class="s1">&#39;NP1&#39;</span><span class="p">,</span> <span class="s1">&#39;OH&#39;</span><span class="p">,</span> <span class="s1">&#39;O3&#39;</span><span class="p">,</span> <span class="s1">&#39;CL&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;NAM&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;N1&#39;</span><span class="p">,</span> <span class="s1">&#39;O2&#39;</span><span class="p">,</span> <span class="s1">&#39;OP&#39;</span><span class="p">,</span> <span class="s1">&#39;SH&#39;</span><span class="p">]</span>
        <span class="n">lgroups</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CG&#39;</span><span class="p">,</span> <span class="s1">&#39;C2N&#39;</span><span class="p">,</span> <span class="s1">&#39;N30&#39;</span><span class="p">,</span> <span class="s1">&#39;N31&#39;</span><span class="p">,</span> <span class="s1">&#39;N32&#39;</span><span class="p">,</span> <span class="s1">&#39;N33&#39;</span><span class="p">,</span> <span class="s1">&#39;NAR&#39;</span><span class="p">,</span> <span class="s1">&#39;OCO&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;NP1&#39;</span><span class="p">,</span> <span class="s1">&#39;OH&#39;</span><span class="p">,</span> <span class="s1">&#39;O3&#39;</span><span class="p">,</span> <span class="s1">&#39;CL&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;NAM&#39;</span><span class="p">,</span> <span class="s1">&#39;N1&#39;</span><span class="p">,</span> <span class="s1">&#39;O2&#39;</span><span class="p">,</span> <span class="s1">&#39;OP&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;SH&#39;</span><span class="p">]</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">begin{{longtable}}{{lllll}}&quot;</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">caption{{Ligand interaction parameters. For interactions not &quot;</span>
             <span class="s2">&quot;listed, the default value of </span><span class="si">{0:s}</span><span class="s2"> is applied.}}&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                 <span class="bp">self</span><span class="o">.</span><span class="n">sidechain_cutoffs</span><span class="o">.</span><span class="n">default</span><span class="p">),</span>
            <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">label{{tab:ligand_interaction_parameters}}</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">toprule&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Group1 &amp; Group2 &amp; Interaction &amp; c1 &amp;c2 </span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">midrule&quot;</span><span class="p">,</span>
            <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">endfirsthead&quot;</span><span class="p">,</span>
            <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">multicolumn{{5}}{{l}}{</span><span class="se">\\</span><span class="s2">emph{{continued from the previous page}}}</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">toprule&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Group1 &amp; Group2 &amp; Interaction &amp; c1 &amp;c2 </span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">midrule&quot;</span><span class="p">,</span>
            <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">endhead&quot;</span><span class="p">,</span>
            <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">midrule&quot;</span><span class="p">,</span>
            <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">multicolumn{{5}}{{r}}{</span><span class="se">\\</span><span class="s2">emph{{continued on the next page}}}</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">endfoot&quot;</span><span class="p">,</span>
            <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">bottomrule&quot;</span><span class="p">,</span>
            <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">endlastfoot&quot;</span><span class="p">,</span>
            <span class="s2">&quot;&quot;</span><span class="p">]</span>
        <span class="n">str_</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">group1</span> <span class="ow">in</span> <span class="n">agroups</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">group2</span> <span class="ow">in</span> <span class="n">lgroups</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">interaction_matrix</span><span class="p">[</span><span class="n">group1</span><span class="p">][</span><span class="n">group2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sidechain_cutoffs</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="n">group1</span><span class="p">,</span> <span class="n">group2</span><span class="p">)</span>
                        <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">sidechain_cutoffs</span><span class="o">.</span><span class="n">default</span><span class="p">):</span>
                    <span class="k">continue</span>
                <span class="n">fmt</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="s2">&quot;</span><span class="si">{grp1:&gt;3s}</span><span class="s2"> &amp; </span><span class="si">{grp2:&gt;3s}</span><span class="s2"> &amp; </span><span class="si">{mat:1s}</span><span class="s2"> &amp; </span><span class="si">{val1:4}</span><span class="s2"> &amp; &quot;</span>
                    <span class="s2">&quot;</span><span class="si">{val2:4}</span><span class="se">\\\\</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">str_</span> <span class="o">+=</span> <span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">group1</span><span class="p">,</span> <span class="n">group2</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">interaction_matrix</span><span class="p">[</span><span class="n">group1</span><span class="p">][</span><span class="n">group2</span><span class="p">],</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">sidechain_cutoffs</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="n">group1</span><span class="p">,</span> <span class="n">group2</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">sidechain_cutoffs</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="n">group1</span><span class="p">,</span> <span class="n">group2</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">group1</span> <span class="o">==</span> <span class="n">group2</span><span class="p">:</span>
                    <span class="k">break</span>
        <span class="n">str_</span> <span class="o">+=</span> <span class="s1">&#39;  </span><span class="se">\\</span><span class="s1">end{{longtable}}</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">info</span><span class="p">(</span><span class="n">str_</span><span class="p">)</span></div>

<div class="viewcode-block" id="Parameters.print_interactions_latex"><a class="viewcode-back" href="../../api/propka.parameters.html#propka.parameters.Parameters.print_interactions_latex">[docs]</a>    <span class="k">def</span> <span class="nf">print_interactions_latex</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Print interactions in LaTeX.&quot;&quot;&quot;</span>
        <span class="c1"># TODO - are these the same lists as above? Convert to module constants.</span>
        <span class="n">agroups</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;COO&#39;</span><span class="p">,</span> <span class="s1">&#39;HIS&#39;</span><span class="p">,</span> <span class="s1">&#39;CYS&#39;</span><span class="p">,</span> <span class="s1">&#39;TYR&#39;</span><span class="p">,</span> <span class="s1">&#39;SER&#39;</span><span class="p">,</span> <span class="s1">&#39;N+&#39;</span><span class="p">,</span> <span class="s1">&#39;LYS&#39;</span><span class="p">,</span> <span class="s1">&#39;AMD&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;ARG&#39;</span><span class="p">,</span> <span class="s1">&#39;TRP&#39;</span><span class="p">,</span> <span class="s1">&#39;ROH&#39;</span><span class="p">,</span> <span class="s1">&#39;CG&#39;</span><span class="p">,</span> <span class="s1">&#39;C2N&#39;</span><span class="p">,</span> <span class="s1">&#39;N30&#39;</span><span class="p">,</span> <span class="s1">&#39;N31&#39;</span><span class="p">,</span> <span class="s1">&#39;N32&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;N33&#39;</span><span class="p">,</span> <span class="s1">&#39;NAR&#39;</span><span class="p">,</span> <span class="s1">&#39;OCO&#39;</span><span class="p">,</span> <span class="s1">&#39;NP1&#39;</span><span class="p">,</span> <span class="s1">&#39;OH&#39;</span><span class="p">,</span> <span class="s1">&#39;O3&#39;</span><span class="p">,</span> <span class="s1">&#39;CL&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;NAM&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;N1&#39;</span><span class="p">,</span> <span class="s1">&#39;O2&#39;</span><span class="p">,</span> <span class="s1">&#39;OP&#39;</span><span class="p">,</span> <span class="s1">&#39;SH&#39;</span><span class="p">]</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">begin{{longtable}}{{</span><span class="si">{0:s}</span><span class="s2">}}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;l&#39;</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">agroups</span><span class="p">)),</span>
            <span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">caption{{Ligand interaction parameters. For interactions not &quot;</span>
             <span class="s2">&quot;listed, the default value of </span><span class="si">{0:s}</span><span class="s2"> is applied.}}&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                 <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sidechain_cutoffs</span><span class="o">.</span><span class="n">default</span><span class="p">)),</span>
            <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">label{{tab:ligand_interaction_parameters}}</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">toprule&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Group1 &amp; Group2 &amp; Interaction &amp; c1 &amp;c2 </span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">midrule&quot;</span><span class="p">,</span>
            <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">endfirsthead&quot;</span><span class="p">,</span>
            <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">multicolumn{{5}}{{l}}{</span><span class="se">\\</span><span class="s2">emph{{continued from the previous page}}}</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">toprule&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Group1 &amp; Group2 &amp; Interaction &amp; c1 &amp;c2 </span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">midrule&quot;</span><span class="p">,</span>
            <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">endhead&quot;</span><span class="p">,</span>
            <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">midrule&quot;</span><span class="p">,</span>
            <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">multicolumn{{5}}{{r}}{</span><span class="se">\\</span><span class="s2">emph{{continued on the next page}}}</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">endfoot&quot;</span><span class="p">,</span>
            <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">bottomrule&quot;</span><span class="p">,</span>
            <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">endlastfoot&quot;</span><span class="p">,</span>
            <span class="s2">&quot;&quot;</span>
        <span class="p">]</span>
        <span class="n">str_</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">group1</span> <span class="ow">in</span> <span class="n">agroups</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">group2</span> <span class="ow">in</span> <span class="n">agroups</span><span class="p">:</span>
                <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{g1:&gt;3s}</span><span class="s1"> &amp; </span><span class="si">{g2:&gt;3s}</span><span class="s1"> &amp; </span><span class="si">{mat:1s}</span><span class="s1"> &amp; </span><span class="si">{val1:&gt;4s}</span><span class="s1"> &amp; </span><span class="si">{val2:&gt;4s}</span><span class="se">\\\\</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">str_</span> <span class="o">+=</span> <span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">group1</span><span class="p">,</span> <span class="n">group2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">interaction_matrix</span><span class="p">[</span><span class="n">group1</span><span class="p">][</span><span class="n">group2</span><span class="p">],</span>
                    <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sidechain_cutoffs</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="n">group1</span><span class="p">,</span> <span class="n">group2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]),</span>
                    <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sidechain_cutoffs</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="n">group1</span><span class="p">,</span> <span class="n">group2</span><span class="p">)[</span><span class="mi">1</span><span class="p">]))</span>
                <span class="k">if</span> <span class="n">group1</span> <span class="o">==</span> <span class="n">group2</span><span class="p">:</span>
                    <span class="k">break</span>
        <span class="n">str_</span> <span class="o">+=</span> <span class="s1">&#39;  </span><span class="se">\\</span><span class="s1">end{{longtable}}</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">info</span><span class="p">(</span><span class="n">str_</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="InteractionMatrix"><a class="viewcode-back" href="../../api/propka.parameters.html#propka.parameters.InteractionMatrix">[docs]</a><span class="k">class</span> <span class="nc">InteractionMatrix</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Interaction matrix class.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize with name of matrix.</span>

<span class="sd">        Args:</span>
<span class="sd">            name:  name of interaction matrix</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ordered_keys</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dictionary</span> <span class="o">=</span> <span class="p">{}</span>

<div class="viewcode-block" id="InteractionMatrix.add"><a class="viewcode-back" href="../../api/propka.parameters.html#propka.parameters.InteractionMatrix.add">[docs]</a>    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">words</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add values to matrix.</span>

<span class="sd">        Args:</span>
<span class="sd">            words:  values to add</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_group</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ordered_keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_group</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">new_group</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictionary</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dictionary</span><span class="p">[</span><span class="n">new_group</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ordered_keys</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dictionary</span><span class="p">[</span><span class="n">group</span><span class="p">][</span><span class="n">new_group</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dictionary</span><span class="p">[</span><span class="n">new_group</span><span class="p">][</span><span class="n">group</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span></div>

<div class="viewcode-block" id="InteractionMatrix.get_value"><a class="viewcode-back" href="../../api/propka.parameters.html#propka.parameters.InteractionMatrix.get_value">[docs]</a>    <span class="k">def</span> <span class="nf">get_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item1</span><span class="p">,</span> <span class="n">item2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get specific matrix value.</span>

<span class="sd">        Args:</span>
<span class="sd">            item1:  matrix row index</span>
<span class="sd">            item2:  matrix column index</span>
<span class="sd">        Returns:</span>
<span class="sd">            matrix value or None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictionary</span><span class="p">[</span><span class="n">item1</span><span class="p">][</span><span class="n">item2</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span></div>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">group</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get specific group from matrix.</span>

<span class="sd">        Args:</span>
<span class="sd">            group:  group to get</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">group</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictionary</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">str_</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{0:s}</span><span class="s1"> not found in interaction matrix </span><span class="si">{1:s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">group</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">str_</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictionary</span><span class="p">[</span><span class="n">group</span><span class="p">]</span>

<div class="viewcode-block" id="InteractionMatrix.keys"><a class="viewcode-back" href="../../api/propka.parameters.html#propka.parameters.InteractionMatrix.keys">[docs]</a>    <span class="k">def</span> <span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get keys from matrix.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dictionary key list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictionary</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">str_</span> <span class="o">=</span> <span class="s1">&#39;      &#39;</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordered_keys</span><span class="p">:</span>
            <span class="n">str_</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">{0:&gt;3s}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="n">str_</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">for</span> <span class="n">key1</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordered_keys</span><span class="p">:</span>
            <span class="n">str_</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">{0:&gt;3s}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key1</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">key2</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordered_keys</span><span class="p">:</span>
                <span class="n">str_</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">{0:&gt;3s}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">key1</span><span class="p">][</span><span class="n">key2</span><span class="p">])</span>
            <span class="n">str_</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">return</span> <span class="n">str_</span></div>


<div class="viewcode-block" id="PairwiseMatrix"><a class="viewcode-back" href="../../api/propka.parameters.html#propka.parameters.PairwiseMatrix">[docs]</a><span class="k">class</span> <span class="nc">PairwiseMatrix</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Pairwise interaction matrix class.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize pairwise matrix.</span>

<span class="sd">        Args:</span>
<span class="sd">            name:  name of pairwise interaction</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dictionary</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>

<div class="viewcode-block" id="PairwiseMatrix.add"><a class="viewcode-back" href="../../api/propka.parameters.html#propka.parameters.PairwiseMatrix.add">[docs]</a>    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">words</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add information to the matrix.</span>

<span class="sd">        TODO - this function unnecessarily bundles arguments into a tuple</span>

<span class="sd">        Args:</span>
<span class="sd">            words:  tuple with assignment information and value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># assign the default value</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">2</span><span class="p">])]</span>
            <span class="k">return</span>
        <span class="c1"># assign non-default values</span>
        <span class="n">group1</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">group2</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">value</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">3</span><span class="p">])]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">group1</span><span class="p">,</span> <span class="n">group2</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">group2</span><span class="p">,</span> <span class="n">group1</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="PairwiseMatrix.insert"><a class="viewcode-back" href="../../api/propka.parameters.html#propka.parameters.PairwiseMatrix.insert">[docs]</a>    <span class="k">def</span> <span class="nf">insert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key1</span><span class="p">,</span> <span class="n">key2</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Insert value into matrix.</span>

<span class="sd">        Args:</span>
<span class="sd">            key1:  first matrix key (row)</span>
<span class="sd">            key2:  second matrix key (column)</span>
<span class="sd">            value:  value to insert</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">key1</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictionary</span> <span class="ow">and</span> <span class="n">key2</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictionary</span><span class="p">[</span><span class="n">key1</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">key1</span> <span class="o">!=</span> <span class="n">key2</span><span class="p">:</span>
                <span class="n">str_</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="s1">&#39;Parameter value for </span><span class="si">{0:s}</span><span class="s1">, </span><span class="si">{1:s}</span><span class="s1"> defined more &#39;</span>
                    <span class="s1">&#39;than once&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key1</span><span class="p">,</span> <span class="n">key2</span><span class="p">))</span>
                <span class="n">warning</span><span class="p">(</span><span class="n">str_</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">key1</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictionary</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dictionary</span><span class="p">[</span><span class="n">key1</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dictionary</span><span class="p">[</span><span class="n">key1</span><span class="p">][</span><span class="n">key2</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span></div>

<div class="viewcode-block" id="PairwiseMatrix.get_value"><a class="viewcode-back" href="../../api/propka.parameters.html#propka.parameters.PairwiseMatrix.get_value">[docs]</a>    <span class="k">def</span> <span class="nf">get_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item1</span><span class="p">,</span> <span class="n">item2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get specified value from matrix.</span>

<span class="sd">        Args:</span>
<span class="sd">            item1:  row index</span>
<span class="sd">            item2:  column index</span>
<span class="sd">        Returns:</span>
<span class="sd">            matrix value (or default)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictionary</span><span class="p">[</span><span class="n">item1</span><span class="p">][</span><span class="n">item2</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span></div>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">group</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get item from matrix corresponding to specific group.</span>

<span class="sd">        Args:</span>
<span class="sd">            group:  group to retrieve</span>
<span class="sd">        Returns:</span>
<span class="sd">            matrix information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">group</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictionary</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">str_</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{0:s}</span><span class="s1"> not found in interaction matrix </span><span class="si">{1:s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">group</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">str_</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictionary</span><span class="p">[</span><span class="n">group</span><span class="p">]</span>

<div class="viewcode-block" id="PairwiseMatrix.keys"><a class="viewcode-back" href="../../api/propka.parameters.html#propka.parameters.PairwiseMatrix.keys">[docs]</a>    <span class="k">def</span> <span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get keys from matrix.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dictionary key list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictionary</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">str_</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">key1</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">key2</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">[</span><span class="n">key1</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">str_</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">{0:s}</span><span class="s1"> </span><span class="si">{1:s}</span><span class="s1"> </span><span class="si">{2:s}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">key1</span><span class="p">,</span> <span class="n">key2</span><span class="p">,</span> <span class="bp">self</span><span class="p">[</span><span class="n">key1</span><span class="p">][</span><span class="n">key2</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">str_</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Jan H. Jensen, Chresten R. Sndergaard, Mats H. M. Olsson, Micha Rostkowski, Nathan A. Baker, Matvey Adzhigirey, Oliver Beckstein, Jimmy Charnley Kromann, Mike Beachy, Toni G, Thomas Holder

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>